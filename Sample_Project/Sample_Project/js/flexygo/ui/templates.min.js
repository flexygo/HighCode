var flexygo;!function(flexygo){!function(ui){!function(templates){templates.ObjectTemplateCache=class{},templates.templateList=function(objectname,module,btn){let wc=module.find("flx-list,flx-view,flx-edit")[0];flexygo.ui.templates.showTemplateList(btn,wc)},templates.showTemplateList=function(btn,ctx){var cntMenu=$("flx-contextmenu")[0];if(!cntMenu.hideMenu(btn)){let menuUl=$("<ul/>");for(let key in ctx.templateList)menuUl.append(flexygo.ui.templates.getListTemplateNode(ctx.templateList[key],key,!0,ctx));for(let key in ctx.viewList)menuUl.append(flexygo.ui.templates.getListTemplateNode(ctx.viewList[key],key,!1,ctx));menuUl.append(flexygo.ui.templates.addNewTemplateNode(ctx.childname)),cntMenu.showMenu(menuUl,btn)}},templates.getListTemplateNode=function(template,key,isTemplate,ctx){let nNode=null;return isTemplate?(nNode=$('<li><span><i class="flx-icon icon-properties-relations" /> '+template+"</span></li>").attr("templateId",key),ctx.templateId==key&&nNode.addClass("active")):(nNode=$('<li><span><i class="flx-icon icon-bullet-list" /> '+template+"</span></li>").attr("templateId",key),ctx.viewId==key&&"generic"==ctx.templateId&&nNode.addClass("active")),nNode.on("click",e=>{let template={isTemplate,value:key};flexygo.ui.templates.saveDefaultTemplate(ctx.getModuleFullId(),template),ctx.init()}),nNode},templates.addNewTemplateNode=function(objectname){let nNode=null;return(nNode=$('<li class="separator develop-only"></li><li class="develop-only"><span><i class="flx-icon icon-admon" />'+flexygo.localization.translate("templates.addnewtemplate")+"</span></li>")).on("click",e=>{flexygo.nav.openPage("edit","sysObjectTemplate","",{ObjectName:objectname},"popup",!1)}),nNode},templates.setDefaultTemplate=function(ctx){let activeTemplates=flexygo.storage.local.get("activeTemplates");if(activeTemplates&&null!=ctx.moduleName){let key=ctx.getModuleFullId();void 0!==activeTemplates[key]&&(activeTemplates[key].isTemplate?(ctx.templateId=activeTemplates[key].value,ctx.viewId="",ctx.templateKey="tpl-"+activeTemplates[key].value):(ctx.viewId=activeTemplates[key].value,ctx.templateId="",ctx.templateKey="view-"+activeTemplates[key].value))}},templates.saveDefaultTemplate=function(key,template){if(null!=template){let activeTemplates=flexygo.storage.local.get("activeTemplates");null==activeTemplates&&(activeTemplates=new Object),activeTemplates[key]=template,flexygo.storage.local.add("activeTemplates",activeTemplates)}},templates.showSortManager=function(objectname,module,btn){let histObj=new flexygo.nav.FlexygoHistory;flexygo.utils.isSizeMobile()?histObj.targetid="modal":histObj.targetid="modal600x640";let buttons=[{name:"apply",text:flexygo.localization.translate("sortmanager.apply"),class:"btn btn-default bg-success",click:function(){$(this).closest(".ui-dialog").find("flx-sortmanager")[0].apply()}},{name:"delete",text:flexygo.localization.translate("sortmanager.clean"),class:"btn btn-default bg-danger",click:function(){$(this).closest(".ui-dialog").find("flx-sortmanager")[0].clean()}}],modal=flexygo.targets.createContainer(histObj,!0,null,!0,buttons);modal.empty(),modal.closest(".ui-dialog").find(".ui-dialog-title").html(flexygo.localization.translate("sortmanager.sort")),modal.closest(".ui-dialog").find(".ui-dialog-buttonset").attr("style","float:left"),modal.append("<flx-sortmanager></flx-filtermanager>"),modal.find("flx-sortmanager")[0].init(module)},templates.iconCategoryFilter=function(e){$(e).toggleClass("txt-info bg-warning");let selected=$(e).closest(".iconlist").find(".bg-warning"),modFilter=[];for(let i=0;i<selected.length;i++)modFilter.push("'"+$(selected[i]).text()+"'");var listMod=$("#mod-sysmod-list-icons")[0];0==modFilter.length?listMod.additionalWhere=null:listMod.additionalWhere="Icons.Category in ("+modFilter.join(",")+")",listMod.refresh()}}(ui.templates||(ui.templates={}))}(flexygo.ui||(flexygo.ui={}))}(flexygo||(flexygo={}));