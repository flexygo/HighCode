var flexygo;!function(flexygo){!function(targets){targets.openNewWindow=function(objectPage,target){let width,height,options;0==target.indexOf("new")&&(target=target.replace("new","")).length>0&&-1!=target.indexOf("x")&&(width=target.split("x")[0],options="scrollbars=yes,status=yes,titlebar=yes,resizable=yes,height="+(height=target.split("x")[1])+",width="+width),objectPage.targetid="current",objectPage.hideNavbar=!0,objectPage.hideMenuBar=!0;let url=flexygo.utils.resolveUrl("~/Index")+"#"+flexygo.history.Base64.encode(JSON.stringify(objectPage));window.open(url,flexygo.utils.uniqueId(),options)},targets.openExternalNewWindow=function(url,authToken,objectPage){let width,height,options="scrollbars=yes,status=yes,titlebar=yes,resizable=yes",target=objectPage.targetid;(target=target.replace("new","").replace("current","").replace("main","").replace("menu","").replace("modal","").replace("popup","")).length>0&&-1!=target.indexOf("x")&&(width=target.split("x")[0],height=target.split("x")[1],width&&height&&(options+=",height="+height+",width="+width)),objectPage.targetid="current",objectPage.hideNavbar=!0,objectPage.hideMenuBar=!0,url.endsWith("/")||(url+="/"),url+="Index?u"+flexygo.history.Base64.encode(JSON.stringify(objectPage))+"&=access_token="+authToken,window.open(url,flexygo.utils.uniqueId(),options)},targets.createContainer=function(histObj,excludeHist,triggerElement,excludeMainframeBtn,buttons){let pageContainer=null;if(histObj.targetid&&0==histObj.targetid.indexOf("popup")){triggerElement&&triggerElement.closest(".pageContainer").length>0&&(histObj.opener=$(triggerElement).closest(".pageContainer").attr("id")),(pageContainer=$('<main class="pageContainer" />')).attr("id",flexygo.utils.uniqueUUID());let width,height,relatedPosition=null;relatedPosition=$(".flx-dialog").length>0?$(".flx-dialog").last():$("#realMain");let size=histObj.targetid.replace("popup","");width=.9*$(window).width(),height=.9*$(window).height(),size.length>0&&-1!=size.indexOf("x")&&(parseInt(size.split("x")[0])<width&&(width=parseInt(size.split("x")[0])),parseInt(size.split("x")[1])<height&&(height=parseInt(size.split("x")[1]))),pageContainer.dialog({position:{my:"left top",at:"left+5 top+5",of:relatedPosition},width,height,dialogClass:"flx-dialog",close:function(){let ev={class:"dialog",type:"closed",sender:$(this).data("context")};flexygo.events.trigger(ev),$(this).dialog("destroy").remove()},buttons}).dialogExtend({closable:!0,maximizable:!0,minimizable:!0,minimizeLocation:"left",collapsable:!1,dblclick:!1})}else if(histObj.targetid&&0==histObj.targetid.indexOf("modal")){let width,height;triggerElement&&triggerElement.closest(".pageContainer").length>0&&(histObj.opener=$(triggerElement).closest(".pageContainer").attr("id")),(pageContainer=$('<main class="pageContainer" />')).attr("id",flexygo.utils.uniqueUUID());let size=histObj.targetid.replace("modal","");size.length>0&&-1!=size.indexOf("x")?(width=parseInt(size.split("x")[0]),height=parseInt(size.split("x")[1])):(width=.9*$(window).width(),height=.9*$(window).height()),pageContainer.dialog({position:{my:"center center",at:"center middle",of:$("body")},width,height,dialogClass:"flx-dialog-modal",modal:!0,close:function(){let ev={class:"dialog",type:"closed",sender:$(this).data("context")};flexygo.events.trigger(ev),$(this).dialog("destroy").remove()},buttons}).dialogExtend({closable:!0,maximizable:!0,minimizable:!1,collapsable:!1,dblclick:!1,modal:!0})}else if(histObj.targetid&&0==histObj.targetid.indexOf("menu")){let width,height;triggerElement&&triggerElement.closest(".pageContainer").length>0&&(histObj.opener=$(triggerElement).closest(".pageContainer").attr("id")),(pageContainer=$('<main class="pageContainer" />')).attr("id",flexygo.utils.uniqueUUID());let size=histObj.targetid.replace("menu","");size.length>0&&-1!=size.indexOf("x")?(width=parseInt(size.split("x")[0]),height=parseInt(size.split("x")[1])):(width=400,height=500);let position={my:"center center",at:"center middle",of:$("body")};triggerElement&&(position={my:"center top",at:"center bottom",of:triggerElement}),pageContainer.dialog({position,width,height,show:{effect:"blind",duration:500},draggable:!1,dialogClass:"flx-dialog-menu",modal:!0,close:function(){$(this).dialog("destroy").remove()},open:function(){let diag=$(this);$(".ui-widget-overlay").bind("click",function(){diag.dialog("destroy").remove()})}}).dialogExtend({closable:!1,maximizable:!1,minimizable:!1,collapsable:!1,dblclick:!1,modal:!1,titlebar:"none"})}else if(histObj.targetid&&0==histObj.targetid.indexOf("main"))triggerElement&&triggerElement.closest(".pageContainer").length>0&&(histObj.opener=$(triggerElement).closest(".pageContainer").attr("id")),excludeHist||flexygo.history.set(histObj),pageContainer=$("#realMain");else if(histObj.targetid&&0==histObj.targetid.indexOf("current"))triggerElement&&triggerElement.closest(".pageContainer").length>0?(pageContainer=triggerElement.closest(".pageContainer"),histObj.opener=$(pageContainer).data("context").opener,pageContainer.is($("#realMain"))&&(excludeHist||flexygo.history.set(histObj))):(excludeHist||flexygo.history.set(histObj),pageContainer=$("#realMain"));else if(histObj.targetid&&0==histObj.targetid.indexOf("opener")){let openerId=histObj.targetid.split("|")[1];pageContainer=openerId?$("#"+openerId):$("#realMain")}else alert("target not implemented!"),pageContainer=$("#realMain");if(pageContainer.data("context",histObj),pageContainer.html(flexygo.utils.loadingMsg()),$("flx-footermenu").empty(),pageContainer.closest(".ui-dialog").length>0&&!excludeMainframeBtn){let btn=$('<a class="flx-icon icon-select icon-margin-right ui-corner-all ui-state-default" href="#" title="Put in main frame" role="button"></a>');btn.on("click",function(){let mainCnt=$(this).closest(".ui-dialog").find(".pageContainer").data("context");mainCnt.targetid="main",$("#realMain").data("context",mainCnt),flexygo.history.set(mainCnt),flexygo.history.go(mainCnt),$(this).parent().find(".ui-dialog-titlebar-close").click()});let titlebar=pageContainer.closest(".ui-dialog").find(".ui-dialog-titlebar-buttonpane");0==titlebar.find(".icon-select").length&&titlebar.append(btn)}return pageContainer}}(flexygo.targets||(flexygo.targets={}))}(flexygo||(flexygo={}));