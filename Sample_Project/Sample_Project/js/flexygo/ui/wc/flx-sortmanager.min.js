var flexygo;!function(flexygo){var ui_1;ui_1=flexygo.ui||(flexygo.ui={}),(ui_1.wc||(ui_1.wc={})).FlxSortManagerElement=class extends HTMLElement{constructor(){super(),this.sorting=!1,this.sortingFrom=null}connectedCallback(){}init(module){this.module=module,this.list=module.find("flx-list, flx-search")[0],this.render()}refresh(){this.render()}clean(){let me=$(this),orderInfo=new Array;this.list.sortByObj(orderInfo,new flexygo.api.TemplateGroupCollection),me.closest(".ui-dialog").find(".ui-dialog-titlebar-close").click()}apply(){let me=$(this),orderInfo=new Array;me.find(".fields.used li").each((i,el)=>{let itm=$(el),ord=new flexygo.api.list.PropertyOrder;ord.Asc=itm.is(".asc"),ord.ObjectName=this.list.objectname,ord.PropertyName=itm.attr("property"),orderInfo.push(ord)});let groupsInfo=new flexygo.api.TemplateGroupCollection;me.find(".groups.used li").each((i,el)=>{let itm=$(el),ord=new flexygo.api.TemplateGroup;ord.OrderMode=itm.is(".asc")?"Asc":"Desc",ord.GroupField=itm.attr("property"),ord.Order=i,groupsInfo[ord.GroupField]=ord}),this.list.sortByObj(orderInfo,groupsInfo),me.closest(".ui-dialog").find(".ui-dialog-titlebar-close").click()}render(){let me=$(this);me.html(`\n                <div class="flex-container">\n                  <div class="tabPanel">\n                    <ul class="nav nav-tabs">\n                      <li class="nav-item active sort">\n                        <a class="nav-link" href="#">${flexygo.localization.translate("sortmanager.sort")}</a>\n                      </li>\n                      <li class="nav-item group">\n                        <a class="nav-link" href="#">${flexygo.localization.translate("sortmanager.groups")}</a>\n                      </li>\n                    </ul>\n                  </div>\n                  <div class="fieldPanel">\n                    <div class="sortData">\n                        <div class="fieldspanel col-6 padding-l" style="padding-bottom:0px">\n                            <div class="box">\n                                <span class="textLabel">${flexygo.localization.translate("sortmanager.fields")}</span>\n                                <div class="sortContainer">\n                                    <ul class="fields unused"></ul>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="fieldspanel col-6 padding-l" style="padding-bottom:0px">\n                            <div class="box">\n                                <span class="textLabel">${flexygo.localization.translate("sortmanager.sort")}</span>\n                                <div class="sortContainer">\n                                    <ul class="fields used"></ul>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="groupData" style="display:none">\n                        <div class="fieldspanel col-6 padding-l" style="padding-bottom:0px">\n                            <div class="box">\n                                <span class="textLabel">${flexygo.localization.translate("sortmanager.groups")}</span>\n                                <div class="sortContainer">\n                                    <ul class="groups unused"></ul>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="fieldspanel col-6 padding-l" style="padding-bottom:0px">\n                            <div class="box">\n                                <span class="textLabel">${flexygo.localization.translate("sortmanager.applied")}</span>\n                                <div class="sortContainer">\n                                    <ul class="groups used"></ul>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                  </div>\n                </div>\n            `),me.find(".nav-item").on("click",e=>{e.stopPropagation(),e.preventDefault();let btn=$(e.currentTarget);btn.closest(".nav-tabs").find(".active").removeClass("active"),btn.addClass("active"),btn.is(".sort")?(btn.closest("flx-sortmanager").find(".groupData").hide(),btn.closest("flx-sortmanager").find(".sortData").show()):(btn.closest("flx-sortmanager").find(".sortData").hide(),btn.closest("flx-sortmanager").find(".groupData").show())});let ul=me.find(".fields.unused");for(let key in this.list.fields)"_objectname"!=key.toLowerCase()&&"_objectwhere"!=key.toLowerCase()&&"_ot"!=key.toLowerCase()&&"_guid"!=key.toLowerCase()&&ul.append('<li class="fieldSortItem asc" property="'+key+'"><i style="border-radius:50%" class="sortIcon fa fa-arrows" /> '+this.list.fields[key]+'<i class="delbutton fa fa-close pull-right" style="display:none"/> </li>');if(this.list.userDefinedGroups&&this.list.groupList&&0!=Object.keys(this.list.groupList).length){let ulOrder=me.find(".groups.unused");for(let key in this.list.groupList)ulOrder.append('<li class="fieldSortItem asc" property="'+key+'"><i style="border-radius:50%" class="sortIcon fa fa-arrows" /> '+(this.list.groupList[key].Label?this.list.groupList[key].Label:key)+'<i class="delbutton fa fa-close pull-right" style="display:none"/> </li>')}else me.find(".tabPanel").hide();if(me.find(".fieldSortItem").on("click",ev=>{let itm=$(ev.currentTarget);itm.closest("ul").is(".unused")?(itm.find("i.sortIcon").removeClass("fa fa-arrows"),itm.find("i.fa-close").show(),me.find(".used").append(itm)):itm.toggleClass("asc dsc")}),me.find(".delbutton").on("click",ev=>{let itm=$(ev.currentTarget).closest("li[property]");itm.find("i.fa-close").hide(),itm.find("i.sortIcon").addClass("fa fa-arrows"),itm.detach(),me.find(".unused").append(itm),ev.stopPropagation(),ev.preventDefault()}),me.find(".fields").sortable({zIndex:999999,connectWith:".fields",appendTo:document.body,helper:"clone",start:(event,ui)=>{this.sortStart(ui.item)},stop:(event,ui)=>{this.sortStop(ui.item)}}).disableSelection(),me.find(".groups").sortable({zIndex:999999,connectWith:".groups",appendTo:document.body,helper:"clone",start:(event,ui)=>{this.sortStart(ui.item)},stop:(event,ui)=>{this.sortStop(ui.item)}}).disableSelection(),this.list.orderObj&&this.list.orderObj.length>0)for(let i=0;i<this.list.orderObj.length;i++){let col=this.list.orderObj[i],field=me.find(".fields.unused [property]").filter(function(){return $(this).attr("property").toLowerCase()==col.PropertyName.toLowerCase()});field.length>0&&(col.Asc||field.toggleClass("asc dsc"),me.find(".fields.used").append(field))}if(this.list.userDefinedGroups&&this.list.groups&&Object.keys(this.list.groups).length>0)for(let key in this.list.groups){let col=this.list.groups[key],field=me.find(".groups.unused [property]").filter(function(){return $(this).attr("property").toLowerCase()==col.GroupField.toLowerCase()});field.length>0&&("desc"==col.OrderMode.toString().toLocaleLowerCase()&&field.toggleClass("asc dsc"),me.find(".groups.used").append(field))}}sortStart(item){this.sortingFrom=item.closest("ul"),this.sorting=!0}sortStop(item){let col=item.closest("ul");col.is(this.sortingFrom)||(col.is(".used")?(item.find("i.sortIcon").removeClass("fa fa-arrows"),item.find("i.fa-close").show()):(item.find("i.sortIcon").addClass("fa fa-arrows"),item.find("i.fa-close").hide())),this.sortingFrom=null,this.sorting=!1}}}(flexygo||(flexygo={})),window.customElements.define("flx-sortmanager",flexygo.ui.wc.FlxSortManagerElement);