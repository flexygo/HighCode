var flexygo;!function(flexygo){!function(ui){!function(wc){wc.FlxEasyLine=class extends HTMLElement{constructor(){super(),this.connected=!1,this.data=null,this.label=null,this.color=null,this.value=null,this.size=null,this.symbol=null,this.rounded=null,this.hideValue=null}static get observedAttributes(){return["ObjectName","ObjectWhere","ModuleName","label","value"]}init(){this.render()}refresh(){this.render()}render(){let me=$(this);if(this.moduleName){let params={ObjectName:me.attr("ObjectName"),ObjectWhere:me.attr("ObjectWhere"),ModuleName:this.moduleName,PageName:flexygo.history.getPageName(me)};flexygo.ajax.post("~/api/EasyLine","GetHTML",params,response=>{response&&(this.data=response.Data,this.renderFromModule())},null,()=>{this.stopLoading()},()=>{this.startLoading()})}else this.renderFromAttr()}renderFromModule(){if(this.data){let data=this.data;for(let i=0;i<this.data.length;i++)this.addEasyLine(data[i].value,data[i].label,data[i].color,data[i].symbol,data[i].size,data[i].rounded,data[i].hideValue)}let parentModule=$(this).closest("flx-module"),wcModule=parentModule[0];parentModule&&wcModule&&wcModule.moduleLoaded(this)}renderFromAttr(){let me=$(this);me.empty(),this.addEasyLine(this.value,me.attr("label"),me.attr("color"),me.attr("symbol"),me.attr("size"),me.attr("rounded"),me.attr("hideValue"))}addEasyLine(value,label,color,symbol,size,rounded,hideValue){let me=$(this),layoutOptions={};switch(size?size.toLocaleLowerCase():""){case"l":layoutOptions.height="auto",layoutOptions.width="150px",layoutOptions.sizeClass="size-l";break;case"m":layoutOptions.height="15px",layoutOptions.width="75px",layoutOptions.sizeClass="size-m";break;case"s":layoutOptions.height="10px",layoutOptions.width="40px",layoutOptions.sizeClass="size-s";break;default:layoutOptions.height="auto",layoutOptions.width="auto",layoutOptions.sizeClass=""}let barColor=`background-color: ${color};`,labelClass=color?"label":"no-label",roundedClass=rounded?"rounded":"",valueClass=hideValue?"no-value":"value",div=$(`<div class="flx-easyline ${layoutOptions.sizeClass}" style="width: ${layoutOptions.width}">\n                            <h5 class="${labelClass}" >${label}</h5>\n                            <div  class="hor-bar-bg ${roundedClass}" style="height: ${layoutOptions.height}">\n                                <div prop="bar" style="${barColor}; height: ${layoutOptions.height}" class="hor-bar-fg ${roundedClass}">\n                                    <div prop="value" class="${valueClass}">${value}</div>\n                                </div>\n                            </div>\n                        </div>`);me.append(div),this.setValue(value,color,symbol)}setValue(value,color,symbol){color||(color=this.color),symbol||(symbol=this.symbol);let me=$(this),bar=me.find(".hor-bar-fg"),hasSymbol=symbol||"",width=parseFloat(value)>100?"100":value;bar.animate({opacity:1,width:`${width}%`},{duration:1e3,easing:"swing",step:(now,fx)=>{let percentage=this.formatValue(now);me.find(".value").html(`${percentage}${hasSymbol}`)},complete:function(){let valueDOM=me.find(".value");valueDOM.html(`${value}${hasSymbol}`),bar.width()<50?(valueDOM.css("padding-left","120%"),valueDOM.css("color",color)):(valueDOM.css("padding-left",""),valueDOM.css("color",""))}})}formatValue(value){let precision=2;value>=1&&(precision=3),value>=9&&(precision=4);let convertedValue=value.toPrecision(precision).toString();return parseFloat(convertedValue)}connectedCallback(){let me=$(this);this.connected=!0,this.objectName=me.attr("ObjectName"),this.objectWhere=me.attr("ObjectWhere"),this.moduleName=me.attr("ModuleName"),this.label=me.attr("label"),this.color=me.attr("color"),this.size=me.attr("size"),this.symbol=me.attr("symbol"),this.value=me.attr("value"),this.rounded=me.attr("rounded"),this.hideValue=me.attr("hideValue"),this.init()}attributeChangedCallback(attrName,oldVal,newVal){let needInit=!1;"modulename"==attrName.toLowerCase()&&newVal&&""!=newVal?(this.moduleName=newVal,needInit=!0):"objectname"==attrName.toLowerCase()&&newVal&&""!=newVal?(this.objectName=newVal,needInit=!0):"objectwhere"==attrName.toLowerCase()&&newVal&&""!=newVal?(this.objectWhere=newVal,needInit=!0):"value"==attrName.toLowerCase()&&newVal&&""!=newVal&&(this.value=newVal,this.connected&&this.setValue(newVal)),this.connected&&needInit&&this.init()}startLoading(){$(this).parents("flx-module").length>0&&$(this).parents("flx-module")[0].startLoading()}stopLoading(){$(this).parents("flx-module").length>0&&$(this).parents("flx-module")[0].stopLoading()}}}(ui.wc||(ui.wc={}))}(flexygo.ui||(flexygo.ui={}))}(flexygo||(flexygo={})),window.customElements.define("flx-easyline",flexygo.ui.wc.FlxEasyLine);