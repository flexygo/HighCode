var flexygo;!function(flexygo){!function(selection){selection.getArray=function(object){let selArr=flexygo.storage.local.get("selection-"+object.toLowerCase());return null==selArr&&(selArr=new Array),selArr},selection.setArray=function(object,selArr){flexygo.storage.local.add("selection-"+object.toLowerCase(),selArr);let ev={class:"selection",type:"changed",sender:null,masterIdentity:object,detailIdentity:selArr};return flexygo.events.trigger(ev),!0},selection.add=function(object,value){let selArr=flexygo.selection.getArray(object);for(var i=0;i<selArr.length;i++)if(selArr[i]===value)return!1;return selArr.push(value),flexygo.selection.setArray(object,selArr)},selection.appendArray=function(object,selArr){let newArr=flexygo.selection.getArray(object).concat(selArr);for(var i=0;i<newArr.length;++i)for(var j=i+1;j<newArr.length;++j)newArr[i]===newArr[j]&&newArr.splice(j--,1);return flexygo.selection.setArray(object,selArr)},selection.remove=function(object,value){let selArr=flexygo.selection.getArray(object);for(var i=0;i<selArr.length;i++)if(selArr[i]===value)return selArr.splice(i,1),flexygo.selection.setArray(object,selArr);return!1},selection.clear=function(object){let ev={class:"selection",type:"changed",sender:null,masterIdentity:object,detailIdentity:null};flexygo.events.trigger(ev),flexygo.storage.local.remove("selection-"+object.toLowerCase())},selection.contains=function(object,value){let selArr=flexygo.selection.getArray(object);for(var i=0;i<selArr.length;i++)if(selArr[i]===value)return!0;return!1},selection.toggle=function(object,value){let selArr=flexygo.selection.getArray(object);for(var i=0;i<selArr.length;i++)if(selArr[i]===value)return selArr.splice(i,1),flexygo.selection.setArray(object,selArr),!1;return selArr.push(value),flexygo.selection.setArray(object,selArr),!0},selection.getFilterString=function(object){let whereString,dataCnf=new flexygo.obj.Entity(object).getConfig();if(dataCnf.UniqueIdentifier){let itmArr=flexygo.selection.getArray(object);return 0==itmArr.length?"(1=0)":(whereString=dataCnf.TableName+"."+dataCnf.UniqueIdentifier,whereString+=" in ('"+itmArr.join("','")+"')")}return flexygo.msg.error("flxmodule.uniqueBagError"),"(1=0)"}}(flexygo.selection||(flexygo.selection={}))}(flexygo||(flexygo={})),function(flexygo){!function(storage){!function(local){var _Timer=3e4;local.add=function(key,value){value=JSON.stringify(value),localStorage.setItem(flexygo.profiles.projectName+"-"+key,value),null==local._saveTimer&&(local._saveTimer=setTimeout(()=>{flexygo.storage.local.save()},_Timer))},local.remove=function(key){localStorage.removeItem(flexygo.profiles.projectName+"-"+key),null==local._saveTimer&&(local._saveTimer=setTimeout(()=>{flexygo.storage.local.save()},_Timer))},local.get=function(key){var value=localStorage.getItem(flexygo.profiles.projectName+"-"+key);return null==value||""==value?null:JSON.parse(value)},local.clear=function(){for(var i=0;i<localStorage.length;i++){let key=localStorage.key(i);key.startsWith(flexygo.profiles.projectName+"-")&&localStorage.removeItem(key)}},local.load=function(){flexygo.ajax.post("~/api/Storage","Load",null,function(response){for(var p in flexygo.storage.local.clear(),response)localStorage.setItem(flexygo.profiles.projectName+"-"+response[p].Key,response[p].Value)})},local.save=function(){local._saveTimer=null;for(var properties=new Array,i=0;i<localStorage.length;i++){let key=localStorage.key(i);key.startsWith(flexygo.profiles.projectName+"-")&&properties.push({key:key.replace(flexygo.profiles.projectName+"-",""),value:localStorage.getItem(key)})}flexygo.ajax.post("~/api/Storage","Save",{Properties:properties},response=>response)}}(storage.local||(storage.local={}))}(flexygo.storage||(flexygo.storage={}))}(flexygo||(flexygo={})),function(flexygo){!function(storage){!function(session){session.add=function(key,value){value=JSON.stringify(value),sessionStorage.setItem(flexygo.profiles.projectName+"-"+key,value)},session.remove=function(key){sessionStorage.removeItem(flexygo.profiles.projectName+"-"+key)},session.clear=function(){for(var i=0;i<sessionStorage.length;i++){let key=sessionStorage.key(i);key.startsWith(flexygo.profiles.projectName+"-")&&sessionStorage.removeItem(key)}},session.reset=function(){sessionStorage.removeItem(flexygo.profiles.projectName+"-DevelopMode")},session.get=function(key){var value=sessionStorage.getItem(flexygo.profiles.projectName+"-"+key);return null==value||""==value?null:JSON.parse(value)}}(storage.session||(storage.session={}))}(flexygo.storage||(flexygo.storage={}))}(flexygo||(flexygo={})),function(flexygo){!function(storage){!function(cache){class cacheResponse{}cache.cacheResponse=cacheResponse,cache.add=function(key,filters,value,minutesToExpire){let tCurrent=moment(),arr=flexygo.storage.session.get(key),delArray=new Array,found=!1;arr||(arr=new Array);for(let i=0;i<arr.length;i++)moment(arr[i].expiredDate).diff(tCurrent,"seconds")<2?delArray.push(i):flexygo.utils.objectsAreEquivalent(arr[i].filters,filters)&&(arr[i].response=value,arr[i].expiredDate=moment().add("minutes",minutesToExpire),found=!0);for(let i=delArray.length-1;i>=0;i--)arr.splice(delArray[i]);if(!found){let itm=new cacheResponse;itm.filters=filters,itm.response=value,itm.expiredDate=moment().add("minutes",minutesToExpire),arr.push(itm)}flexygo.storage.session.add(key,arr)},cache.remove=function(key,filters){let tCurrent=moment(),arr=flexygo.storage.session.get(key),delArray=new Array;if(arr&&arr.length>0){for(let i=0;i<arr.length;i++)if(moment(arr[i].expiredDate).diff(tCurrent,"seconds")<2)delArray.push(i);else if(flexygo.utils.objectsAreEquivalent(arr[i].filters,filters)){delArray.push(i);break}for(let i=delArray.length-1;i>=0;i--)arr.splice(delArray[i]);flexygo.storage.session.add(key,arr)}},cache.clear=function(key){flexygo.storage.session.remove(key)},cache.get=function(key,filters){let tCurrent=moment(),arr=flexygo.storage.session.get(key),ret=null,delArray=new Array;if(!arr||0==arr.length)return null;for(let i=0;i<arr.length;i++)if(moment(arr[i].expiredDate).diff(tCurrent,"seconds")<2)delArray.push(i);else if(flexygo.utils.objectsAreEquivalent(arr[i].filters,filters)){ret=arr[i];break}for(let i=delArray.length-1;i>=0;i--)arr.splice(delArray[i]);return flexygo.storage.session.add(key,arr),ret}}(storage.cache||(storage.cache={}))}(flexygo.storage||(flexygo.storage={}))}(flexygo||(flexygo={}));