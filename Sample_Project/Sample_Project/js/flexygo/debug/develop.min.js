var flexygo;!function(flexygo){!function(debug){debug.toggleDevelopMode=function(showAnimation){flexygo.storage.session.add("DevelopMode",!flexygo.debug.isDevelopMode()),flexygo.debug.enableDevelopMode(flexygo.debug.isDevelopMode(),showAnimation)},debug.enableDevelopMode=function(enable,showAnimation){$("body").find("flx-versioninfo").each((i,e)=>{e.refresh()});let wcSidePanel=$("#mainSidePanel")[0];enable&&void 0!==wcSidePanel?(showAnimation&&flexygo.debug.launchAnimation(),$("body").addClass("develop"),$("#mainSidePanel").css("display","flex"),wcSidePanel.addPanel("Page Config.","fa fa-cogs",flexygo.debug.getPagePanel(),!0),flexygo.utils.isSizeMobile()):($("#mainSidePanel").css("display","none"),$("body").removeClass("develop"),void 0!==wcSidePanel&&wcSidePanel.removePanel("Page Config."),flexygo.events.off($("#realMain"),"page","loaded"),$("#mainSidePanel .side-items > span").off("click"))},debug.getPagePanel=function(){let container=$("<div/>"),panel=$('<flx-accordion class="props-accordion" />'),panelCtx=panel[0];if(panelCtx){let manage=$('<span class="clickable"/>').html('<i class="flx-icon icon-properties-settings icon-margin-right "></i>'+flexygo.localization.translate("develop.modulemanager")).on("click",()=>{flexygo.debug.manageModules($("#realMain"))}),AdminPage=$('<span class="clickable"/>').html('<i class="flx-icon icon-laptop icon-margin-right "></i>'+flexygo.localization.translate("develop.adminarea")+"</span>").on("click",()=>{flexygo.nav.openPageName("syspage-generic-admon","","","null","current",!1,$(this))}),helpPage=$('<span class="clickable"/>').html('<i class="flx-icon icon-information-2 icon-margin-right "></i>'+flexygo.localization.translate("develop.help")+"</span>").on("click",()=>{flexygo.nav.openPageName("db6ce0fb-2f28-4056-b14e-e9aed2769f97","sysHelp","",null,"current",!1,$(this))});panelCtx.add('<span><i class="flx-icon  icon-laptop icon-margin-right"></i>'+flexygo.localization.translate("develop.developer")+"</span>",[AdminPage,helpPage]);let newPageStr='<span class="newPage" title="New Page" ><i class="size-m txt-outstanding  flx-icon icon-new-doc icon-margin-right pull-right"></i></span>',pageView=$('<span class="clickable"/>').html('<i class="flx-icon icon-listbox icon-margin-right "></i>'+flexygo.localization.translate("develop.pageSettings")+"</span>").on("click",()=>{let pageContext=flexygo.history.get($("#realMain"));flexygo.nav.openPage("view","sysPage","Pagename='"+pageContext.pagename+"'",null,"popup",!0)});panelCtx.add('<span><i class="flx-icon icon-document icon-margin-right"></i>'+flexygo.localization.translate("develop.page")+newPageStr+"</span>",[pageView]),$(panelCtx).find(".newPage").on("click",event=>{flexygo.nav.openPage("edit","sysPage",null,"null","current",!1),event.stopPropagation()});let objConfig=$('<span class="clickable"/>').html('<i class="flx-icon icon-modules-settings icon-margin-right "></i>'+flexygo.localization.translate("develop.settings")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.getConfig();flexygo.nav.openPage("edit","sysObject","Objectname='"+cnf.ObjectName+"'",null,"popup",!0)}else flexygo.msg.warning(flexygo.localization.translate("develop.selectobject"));event.stopPropagation()}),objView=$('<span class="clickable"/>').html('<i class="flx-icon icon-cube1 icon-margin-right "></i>'+flexygo.localization.translate("develop.viewobject")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.getConfig();flexygo.nav.openPage("view","sysObject","Objectname='"+cnf.ObjectName+"'",null,"popup",!0)}else flexygo.msg.warning(flexygo.localization.translate("develop.selectobject"));event.stopPropagation()}),objWizard=$('<span class="clickable"/>').html('<i class="fa fa-magic icon-margin-right "></i>'+flexygo.localization.translate("develop.wizard")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.getConfig();flexygo.nav.openPageName("syspage-generic-objectwizard","sysObject","ObjectName='"+cnf.ObjectName+"'","null","current",!1)}else flexygo.msg.warning(flexygo.localization.translate("develop.selectobject"));event.stopPropagation()}),objImageManager=$('<span class="clickable"/>').html('<i class="fa fa-image icon-margin-right "></i>'+flexygo.localization.translate("develop.imagemanager")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.objectName?obj.getConfig():null,defaults={ObjectName:cnf?cnf.ObjectName:"",KeyProperty:cnf&&1===cnf.KeyFields.length?cnf.KeyFields[0]:""};flexygo.nav.openPage("edit","sysObjectImageSetting",cnf?"ObjectName = '"+cnf.ObjectName+"'":null,defaults,"modal900x500",!1,$(this))}else flexygo.msg.warning(flexygo.localization.translate("develop.selectobject"));event.stopPropagation()}),objDocumentManager=$('<span class="clickable"/>').html('<i class="flx-icon icon-document icon-margin-right "></i>'+flexygo.localization.translate("develop.documentmanager")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.objectName?obj.getConfig():null,defaults={ObjectName:cnf?cnf.ObjectName:"",ObjectPK:cnf&&1===cnf.KeyFields.length?cnf.KeyFields[0]:""};flexygo.nav.openPage("edit","Documents_Object_Config",cnf?"ObjectName = '"+cnf.ObjectName+"'":null,defaults,"modal900x580",!1,$(this))}else flexygo.msg.warning(flexygo.localization.translate("develop.selectobject"));event.stopPropagation()}),objMailManager=$('<span class="clickable"/>').html('<i class="flx-icon icon-email-settings icon-margin-right "></i>'+flexygo.localization.translate("develop.mailmanager")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.objectName?obj.getConfig():null,defaults={ObjectName:cnf?cnf.ObjectName:"",KeyProperty:cnf&&1===cnf.KeyFields.length?cnf.KeyFields[0]:""};flexygo.nav.openPage("edit","Mail_Object_Config",cnf?"ObjectName = '"+cnf.ObjectName+"'":null,defaults,"modal900x580",!1,$(this))}else flexygo.msg.warning(flexygo.localization.translate("develop.selectobject"));event.stopPropagation()}),objChatter=$('<span class="clickable"/>').html('<i class="flx-icon icon-chats icon-margin-right "></i>'+flexygo.localization.translate("develop.chatter")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.objectName?obj.getConfig():null,defaults={ObjectName:cnf?cnf.ObjectName:"",ObjectPK:cnf&&1===cnf.KeyFields.length?cnf.KeyFields[0]:""};flexygo.nav.openPage("edit","sysChatter_Config",cnf?"ObjectName = '"+cnf.ObjectName+"'":null,defaults,"modal900x400",!1,$(this))}else flexygo.msg.warning(flexygo.localization.translate("develop.selectobject"));event.stopPropagation()}),newObjectStr='<span class="newObject" title="New Object" ><i class="size-m txt-outstanding  flx-icon icon-password icon-margin-right pull-right"></i></span>';panelCtx.add('<span><i class="flx-icon icon-object icon-margin-right"></i>'+flexygo.localization.translate("develop.object")+newObjectStr+"</span>",[objConfig,objView,objWizard,objImageManager,objDocumentManager,objChatter,objMailManager]),$(panelCtx).find(".newObject").on("click",event=>{flexygo.nav.openPageName("syspage-generic-objectwizard","sysObject","","null","current",!1),event.stopPropagation()});let colConfig=$('<span class="clickable"/>').html('<i class="flx-icon icon-modules-settings icon-margin-right "></i>'+flexygo.localization.translate("develop.settings")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.getConfig();flexygo.nav.openPage("edit","sysObject","Objectname='"+cnf.ParentName+"'",null,"popup",!0)}else flexygo.msg.warning(flexygo.localization.translate("develop.selectobject"));event.stopPropagation()});panelCtx.add('<span><i class="flx-icon icon-bullet-list-3 icon-margin-right"></i>'+flexygo.localization.translate("develop.collection")+"</span>",[colConfig]),panelCtx.add('<span><i class="flx-icon icon-icons icon-margin-right"></i>'+flexygo.localization.translate("develop.modules")+"</span>",manage);let securityUsers=$('<span class="clickable"/>').html('<i class="flx-icon icon-user-3 icon-margin-right "></i>'+flexygo.localization.translate("develop.users")+"</span>").on("click",event=>{flexygo.nav.openPage("list","sysUsers","",null,"current",!1)}),securityRoles=$('<span class="clickable"/>').html('<i class="flx-icon icon-group1 icon-margin-right "></i>'+flexygo.localization.translate("develop.roles")+"</span>").on("click",event=>{flexygo.nav.openPage("list","sysRoles","",null,"current",!1)}),objProcessSecurity=$('<span class="clickable"/>').html('<i class="flx-icon icon-process icon-margin-right "></i>'+flexygo.localization.translate("develop.objectprocesssecurity")+"</span>").on("click",event=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.getConfig();flexygo.nav.openPageName("syspage-generic-objectprocesssecurity","sysObject","Objectname='"+cnf.ObjectName+"'","null","current",!1)}else flexygo.msg.info(flexygo.localization.translate("develop.selectobject"))}),objPropertySecurity=$('<span class="clickable"/>').html('<i class="flx-icon icon-object-properties-2 icon-margin-right "></i>'+flexygo.localization.translate("develop.objectpropertysecurity")+"</span>").on("click",()=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.getConfig();flexygo.nav.openPageName("syspage-generic-objectpropertysecurity","sysObject","Objectname='"+cnf.ObjectName+"'","null","current",!1)}else flexygo.msg.info(flexygo.localization.translate("develop.selectobject"))}),objSecurity=$('<span class="clickable"/>').html('<i class="flx-icon icon-object icon-margin-right "></i>'+flexygo.localization.translate("develop.objectsecurity")+"</span>").on("click",()=>{let pageContext=flexygo.history.get($("#realMain")),obj=new flexygo.obj.Entity(pageContext.objectname);if(void 0!==pageContext.objectname){let cnf=obj.getConfig();flexygo.nav.openPageName("syspage-generic-objectsecurity","sysObject","Objectname='"+cnf.ObjectName+"'","null","popup",!1)}else flexygo.msg.info(flexygo.localization.translate("develop.selectobject"))});panelCtx.add('<span><i class="flx-icon icon-group-security icon-margin-right"></i>'+flexygo.localization.translate("develop.security")+"</span>",[securityUsers,securityRoles,objSecurity,objProcessSecurity,objPropertySecurity]),container.append(panel)}let resp=$('<div id="responsivePanels" />'),desktopIcon=$('<div class="respDesktop"><i class="flx-icon icon-desktop-1"></i></div>'),TabletPortraitIcon=$('<div class="respTabletPortrait"><i class="flx-icon icon-tablet-1"></i></div>'),TabletLandscapeIcon=$('<div class="respTabletLandscape"><i class="flx-icon icon-tablet-1 icon-rotate-90"></i></div>'),MobilePortraitIcon=$('<div class="respMobilePortrait"><i class="flx-icon icon-mobile"></i></div>'),MobileLandscapeIcon=$('<div class="respMobileLandscape"><i class="flx-icon icon-mobile icon-rotate-90"></i></div>');return resp.append(desktopIcon).append(TabletPortraitIcon).append(TabletLandscapeIcon).append(MobilePortraitIcon).append(MobileLandscapeIcon),resp.children(":not(.respDesktop)").on("click",e=>{let element=$(e.target);element.is("i.flx-icon")&&(element=element.closest("div"));let myIframe=$("#responsiveFrame");0==myIframe.length&&(myIframe=$('<div id="responsiveFrame" onclick="$(this).remove();"><div><div id="respDevice"><iframe src="'+document.location.href+'" /></div></div></div>'),$("body").append(myIframe)),myIframe.find("#respDevice").attr("class",element.attr("class")+"Frame")}),resp.children(".respDesktop").on("click",()=>{$("#responsiveFrame").remove()}),container.append(resp),container.children()},debug.isDevelopMode=function(){return!!flexygo.storage.session.get("DevelopMode")},debug.launchAnimation=function(){let anim="";anim+='<div id="debugBackground">',anim+='<table style="margin: 0 auto;height:300px;">',anim+="  <tr>",anim+='    <td><canvas id="devFirstBracket" width=40 height=120></canvas></td>',anim+='    <td><div id="developerLogo" style="width: 500px;">Developer</div></td>',anim+='    <td><canvas id="devLastBracket" width=40 height=120></canvas></td>',anim+="  </tr>",anim+="</table>",anim+="</div>",$("body").append('<div id="debugBackground"><table style="margin: 0 auto;height:300px;">  <tr>    <td><canvas id="devFirstBracket" width=40 height=120></canvas></td>    <td><div id="developerLogo" style="width: 500px;">Developer</div></td>    <td><canvas id="devLastBracket" width=40 height=120></canvas></td>  </tr></table></div>'),$("body").on("click.debug",function(){$("#debugBackground").remove(),$("body>.ui-effects-wrapper").remove(),$("body").off("click.debug")}),$("#developerLogo").textillate({autoStart:!1,in:{delayScale:2,delay:40,effect:"flipInY",callback:function(){$("#debugBackground").hide("clip",null,400,function(){$("#debugBackground").remove(),$("body>.ui-effects-wrapper").remove(),$("body").off("click.debug")})}}}),$("#debugBackground").show("fold",null,500,function(){setTimeout("flexygo.debug._drawText($('#devFirstBracket'),'{');",500),setTimeout("flexygo.debug._drawText($('#devLastBracket'),'}');",500),$("#developerLogo").textillate("start")})},debug.manageDependencies=function(ObjectName,PropertyName,targetid){targetid||(targetid="modal");let histObj=new flexygo.nav.FlexygoHistory;histObj.targetid=targetid;let modal=flexygo.targets.createContainer(histObj,!0,null,!0);modal.empty(),modal.closest(".ui-dialog").find(".ui-dialog-title").html(flexygo.localization.translate("develop.dependencymanager")+" - "+ObjectName+" "+PropertyName),modal.append('<flx-dependencymanager ObjectName="'+ObjectName+'" PropertyName="'+PropertyName+'"></flx-dependencymanager>')},debug.manageFilters=function(ObjectName,targetid,generic,parentModule){targetid||(targetid="popup");let histObj=new flexygo.nav.FlexygoHistory;histObj.targetid=targetid;let buttons=[{name:"save",text:flexygo.localization.translate("filtermanager.save"),class:"btn btn-default bg-success",click:function(){$(this).trigger("click")}},{name:"delete",text:flexygo.localization.translate("filtermanager.delete"),class:"btn btn-default bg-danger",click:function(){$(this).trigger("click")}}],modal=flexygo.targets.createContainer(histObj,!0,null,!0,buttons),active="";if(parentModule){let wcFilter=parentModule.find("flx-filter")[0];wcFilter&&wcFilter.active&&wcFilter.active.length>0&&(active='active="'+wcFilter.active+'"')}modal.empty(),modal.closest(".ui-dialog").find(".ui-dialog-title").html(flexygo.localization.translate("develop.filtermanager")+" - "+ObjectName),modal.closest(".ui-dialog").find(".ui-dialog-buttonset").attr("style","float:left"),modal.append('<flx-filtermanager generic="'+generic+'" ObjectName="'+ObjectName+'"'+active+"></flx-filtermanager>"),modal.find("flx-filtermanager")[0].parentModule=parentModule},debug.manageModules=function(targetItem){let pageContext=flexygo.history.get(targetItem);if(!pageContext||void 0===pageContext.pagename||null==pageContext.pagename)return void flexygo.msg.error("Can't find page name");let histObj=new flexygo.nav.FlexygoHistory;histObj.targetid="popup1024x800";let modal=flexygo.targets.createContainer(histObj,!0,null,!0);modal.empty(),modal.closest(".ui-dialog").find(".ui-dialog-title").html(flexygo.localization.translate("develop.modulemanager")),modal.addClass("nopadding"),modal.append('<flx-modulemanager pageName="'+pageContext.pagename+'" ObjectName="'+pageContext.objectname+'"></flx-modulemanager>'),modal.find("flx-modulemanager")[0].targetItem=targetItem},debug.manageNodes=function(targetItem,NodeId){let histObj=new flexygo.nav.FlexygoHistory;histObj.targetid="popup1024x800";let modal=flexygo.targets.createContainer(histObj,!0,null,!0);modal.empty(),modal.closest(".ui-dialog").find(".ui-dialog-title").html(flexygo.localization.translate("develop.nodemanager")),modal.addClass("nopadding"),modal.append('<flx-nodemanager initNode="'+NodeId+'" ></flx-nodemanager>')},debug._drawText=function(itm,txt){if(itm.length>0){let ctx=itm[0].getContext("2d"),dashLen=220,dashOffset=dashLen,speed=5,x=0,i=0;ctx.font="120px Arial",ctx.lineWidth=1,ctx.lineJoin="round",ctx.globalAlpha=2/3,ctx.strokeStyle=ctx.fillStyle="#ddd",function loop(){ctx.clearRect(x,0,60,150),ctx.setLineDash([dashLen-dashOffset,dashOffset-speed]),dashOffset-=speed,ctx.strokeText(txt[i],x,90),dashOffset>0?requestAnimationFrame(loop):(dashOffset=dashLen,x+=ctx.measureText(txt[i++]).width+ctx.lineWidth*Math.random(),i<txt.length&&requestAnimationFrame(loop))}()}}}(flexygo.debug||(flexygo.debug={}))}(flexygo||(flexygo={})),function(flexygo){!function(debug){!function(test_1){test_1.show=function(){flexygo.ajax.post("~/api/Test","GetTests",{},function(res){res.length>0&&flexygo.debug.test.drawTest(res)})},test_1.drawTest=function(tests){let targetid="",histObj={targetid:targetid=flexygo.utils.isSizeMobile()?"current":"modal"},pageContainer=flexygo.targets.createContainer(histObj,!0,null);pageContainer.closest(".ui-dialog").find(".ui-dialog-title").html('<i class="flx-icon icon-develop"></i> Flexygo Diagnostics');let navString='<div class="row padding-l">';navString+='<flx-container type="emptyCnt">',navString+='<div class="row">',navString+='<div class="col-1"><h3>Status</h3></div>',navString+='<div class="col-4"><h3>Name</h3></div>',navString+='<div class="col-7"><h3>More Info</h3></div>',navString+="</div>",navString+='<div class="bg-white">';for(let i=0;i<tests.length;i++)navString+='<div class="row padding-s" testId="'+tests[i].TestId+'" testName="'+tests[i].TestName+'" testClass="'+tests[i].TestClass+'">',navString+='<div class="testStat col-1">&nbsp;</div>',navString+='<div class="testDescrip col-4"><a href="#" onclick="$(this).closest(\'[testName]\').addClass(\'testPending\');flexygo.debug.test.executeTests($(this).closest(\'flx-container\'));event.stopPropagation();event.preventDefault();" ><h6 class="txt-primary"><span class="size-s">'+tests[i].TestTile+" "+tests[i].TestName+"</span></h6></a></div>",navString+='<div class="testResult col-7 size-s"></div>',navString+="</div>";navString+="</div>",navString+="</flx-container>",navString+="</div>",navString+='<div style="margin-top:20px" class="row padding-l">',navString+='<button class="execTest btn btn-default bg-success">Run All <i class="flx-icon icon-play" /></button>',navString+="</div>",pageContainer.html(navString),pageContainer.find(".execTest").on("click",function(){$(this).prop("disabled",!0),$(this).html('Executing... <i class="flx-icon icon-load icon-spin"></i>'),pageContainer.find("[testName]").addClass("testPending"),flexygo.debug.test.executeTests(pageContainer)})},test_1.executeTests=function(testPanel){let test=testPanel.find("[testName].testPending");if(test.length>0){let testRow=$(test[0]),testName=testRow.attr("testName"),testClass=testRow.attr("testClass"),testId=testRow.attr("testId");testRow.find(".testStat").html('<i class="flx-icon icon-load icon-spin"></i>'),testRow.find(".testDescrip h6").attr("class","txt-info"),flexygo.ajax.post("~/api/Test","ExecuteTest",{TestName:testName,ClassName:testClass,TestId:testId},function(res){flexygo.debug.test.executeTestRes(testPanel,res)})}},test_1.executeTestRes=function(testPanel,test){let el=testPanel.find('[testName="'+test.TestName+'"]');el.length>0&&(el.removeClass("testPending"),test.Result?(el.find(".testStat").html('<i class="flx-icon icon-accepted txt-success"></i>'),el.find(".testDescrip h6").attr("class","txt-success")):(el.find(".testStat").html('<i class="flx-icon icon-close txt-danger"></i>'),el.find(".testDescrip h6").attr("class","txt-danger"),el.find(".testResult").html(flexygo.utils.parser.replaceAll(test.LastError,"\n","<br/>")),console.error(test.LastError)),(test=testPanel.find("[testName].testPending")).length>0?flexygo.debug.test.executeTests(testPanel):(testPanel.find(".execTest").prop("disabled",!1),testPanel.find(".execTest").html('Run All <i class="flx-icon icon-play" />')))}}(debug.test||(debug.test={}))}(flexygo.debug||(flexygo.debug={}))}(flexygo||(flexygo={}));