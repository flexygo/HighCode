function initApp(){flexygo.storage.session.reset(),flexygo.storage.local.load(),$(window).unload(function(){flexygo.storage.local._saveTimer&&(clearTimeout(flexygo.storage.local._saveTimer),flexygo.storage.local.save())})}function initPage(){let main,footer,sidepanel,hist,oldIcon,newIcon;main=$("main#realMain"),footer=$('<flx-footermenu id="mainFooterMenu"></flx-footer>'),sidepanel=$('<flx-sidepanel id="mainSidePanel"></flx-sidepanel>'),main.after(footer),main.after(footer),footer.after(sidepanel),$("body").append('<flx-contextmenu id="flx-menu"></flx-contextmenu>'),flexygo.debug&&flexygo.debug.isDevelopMode&&flexygo.debug.isDevelopMode()&&flexygo.debug.enableDevelopMode(!0,!1),flexygo.utils.isAgentMobile()&&!flexygo.utils.isSizeMobile()&&$('meta[name="viewport"]').attr("content","width="+(parseInt(flexygo.utils.size.m.toString().replace("px",""))-5)+"px"),navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&$("meta[name=viewport]").attr("content",$("meta[name=viewport]").attr("content")+", maximum-scale=1, user-scalable=0"),flexygo.utils.isAgentMobile()&&flexygo.utils.isSizeMobile()&&$(document).on("mousedown",function(ev){0!==$(ev.target).closest("#mainMenu, #mainNav, #buttonNav, #buttonMenu").length||$(ev.target).is("#mainMenu, #mainNav, #buttonNav, #buttonMenu")||($("#mainMenu").is(":visible")?flexygo.nav.toggleFlxnav($("#mainMenu")):$("#mainNav").is(":visible")&&flexygo.nav.toggleFlxnav($("#mainNav")))}),flexygo.utils.isTactilModeActive()&&$("html").addClass("tactilMode"),flexygo.utils.isFullScreenActive()?(oldIcon="icon-expand-4",newIcon="icon-collapse"):(oldIcon="icon-collapse",newIcon="icon-expand-4"),$('#mainMenu li[title="Toggle full screen"] i').removeClass(oldIcon),$('#mainMenu li[title="Toggle full screen"] i').addClass(newIcon);let param=flexygo.utils.querystring.getParamValue(document.location.href,"u");if(param){let dataObj=flexygo.history.Base64.decode(param);hist=JSON.parse(dataObj),window.history.replaceState(hist,null,flexygo.utils.resolveUrl("~/Index")+"#"+param)}else hist=getUrlObject();hist&&(void 0!==hist.hideNavbar&&!0===hist.hideNavbar&&($("#mainNav").hide().attr("minimized","True"),$("#miniButton i").removeClass("flipped")),void 0!==hist.hideMenuBar&&!0===hist.hideMenuBar&&($("#mainMenu").hide().attr("minimized","True"),$("header").hide())),$("body").show(500,function(){loadPage(hist)}),flexygo.utils.onlineCheck(6e4)}function resizeMain(){flexygo.utils.isSizeMobile()||$("#mainBlock").css("min-height",$("body.header-follows").length>0||$("body.header-overflow").length>0?"100%":$(window).height()-$("header:first").outerHeight()+"px")}function loadPage(hist){hist?(flexygo.history.go(hist),hist.successMessage&&flexygo.msg.success(hist.successMessage),hist.errorMessage&&flexygo.msg.error(hist.errorMessage)):flexygo.nav.goHome(!0),flexygo.localization.init(),resizeMain()}function getUrlObject(){try{let b64,items;return(b64=$.trim(document.location.href)).endsWith("#")&&(b64=b64.substring(0,b64.length-1)),b64.endsWith("/")&&(b64=b64.substring(0,b64.length-1)),b64.endsWith("#")&&(b64=b64.substring(0,b64.length-1)),items=b64.split("/"),(b64=items[items.length-1]).toLowerCase().startsWith("index#")?(b64=b64.substring(6),JSON.parse(flexygo.history.Base64.decode(b64))):null}catch(e){return null}}$(function(){$(document).on("ready",initPage),flexygo.events.on(this,"page","loading",function(e){NProgress.start()}),flexygo.events.on(this,"page","loaded",function(e){NProgress.done()}),flexygo.events.on(this,"message","all",function(e){"exception"===e.type?flexygo.exceptions.httpShow(e.sender):flexygo.msg.generic(e.detailIdentity,null,e.masterIdentity,null,e.type)}),window.addEventListener("dragenter",function(e){e.preventDefault()},!1),window.addEventListener("dragover",function(e){e.preventDefault()}),window.addEventListener("drop",function(e){e.preventDefault()}),window.addEventListener("resize",resizeMain),$.ui.dialog.prototype._createOverlay=function(){if(this.options.modal){this._delay(function(){!1}),this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}}});